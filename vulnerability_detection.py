while True:
    for device in iot_network.devices.values():
        if detect_vulnerability(device.device_id):
            if not device.blocked:
                print(f"Vulnerability detected! Blocking device {device.device_id}")
                device.block_device()
        else:
            if device.blocked:
                print(f"Vulnerability cleared! Unblocking device {device.device_id}")
                device.unblock_device()

    time.sleep(5)  # Check for vulnerabilities every 5 seconds (or adjust the interval as needed)

def issue_detected():
    # Replace this function with your own logic to detect issues
    return True

def prompt_approval():
    root = tk.Tk()
    root.withdraw()
    approval = messagebox.askyesno("IoTShield", "IoTShield has detected a small issue. Please give authority to send this data.")
    root.destroy()
    return approval


if issue_detected():
    if prompt_approval():
        report_issue()

def run_vulnerability_check():
    while True:
        for device in iot_network.devices.values():
            if detect_vulnerability(device.device_id):
                if not device.blocked:
                    print(f"Vulnerability detected! Blocking device {device.device_id}")
                    device.block_device()
            else:
                if device.blocked:
                    print(f"Vulnerability cleared! Unblocking device {device.device_id}")
                    device.unblock_device()

        time.sleep(5)  # Check for vulnerabilities every 5 seconds (or adjust the interval as needed)

